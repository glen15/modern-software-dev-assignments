# 코드 리뷰 실습

## 개요

효과적인 코드 리뷰 방법을 배우고, 수동 리뷰와 AI 보조 리뷰를 실습합니다.

---

## 학습 목표

- 코드 리뷰의 목적과 중요성을 이해한다
- 체계적인 리뷰 방법을 익힌다
- 건설적인 피드백을 작성할 수 있다
- AI 도구를 활용한 리뷰 방법을 익힌다

---

## 1. 코드 리뷰란?

### 정의

다른 개발자가 작성한 코드를 검토하여 품질을 향상시키는 활동

### 목적

1. **버그 발견**: 배포 전 문제 조기 발견
2. **지식 공유**: 팀원 간 기술/도메인 지식 전파
3. **코드 품질 향상**: 가독성, 유지보수성 개선
4. **보안 강화**: 취약점 발견 및 수정
5. **일관성 유지**: 코딩 스타일, 패턴 통일

---

## 2. 효과적인 코드 리뷰 방법

### 리뷰 전 준비

1. **컨텍스트 파악**
   - PR 설명 읽기
   - 관련 티켓/이슈 확인
   - 변경 범위 파악

2. **로컬에서 실행**
   - 코드 체크아웃
   - 실제 동작 확인
   - 테스트 실행

### 리뷰 순서

```
1. 전체 흐름 파악 (Big Picture)
   - 아키텍처 변경?
   - 새로운 의존성?

2. 핵심 로직 검토
   - 비즈니스 로직 정확성
   - 알고리즘 효율성

3. 세부 사항 확인
   - 명명 규칙
   - 에러 처리
   - 코드 스타일

4. 테스트 확인
   - 테스트 존재 여부
   - 테스트 커버리지
```

### 리뷰 시간 관리

- 한 번에 200-400줄 이하 리뷰
- 60-90분 이상 연속 리뷰 금지
- 큰 PR은 분할 요청

---

## 3. 건설적인 피드백 작성

### 좋은 피드백의 특징

| 특징 | 설명 |
|------|------|
| 구체적 | 정확한 위치와 문제점 명시 |
| 이유 포함 | 왜 변경이 필요한지 설명 |
| 대안 제시 | 가능하면 해결책 제안 |
| 존중적 | 코드 비판, 사람 비판 X |

### 피드백 템플릿

```
[유형] 간단한 요약

상세 설명:
- 현재 코드의 문제점
- 왜 문제인지 이유

제안:
- 구체적인 개선 방안
- (선택) 코드 예시
```

### 예시

```
[보안] SQL 인젝션 취약점

현재 코드에서 사용자 입력을 직접 쿼리에 삽입하고 있습니다.
악의적인 입력으로 데이터베이스가 손상될 수 있습니다.

제안:
파라미터화된 쿼리를 사용해주세요:

# 수정 전
query = f"SELECT * FROM users WHERE id = {user_id}"

# 수정 후
query = "SELECT * FROM users WHERE id = :id"
result = db.execute(query, {"id": user_id})
```

---

## 4. AI 보조 코드 리뷰

### AI 리뷰 도구 활용

AI 도구에 다음과 같이 요청할 수 있습니다:

```
이 코드를 리뷰해줘. 다음 관점에서 검토해줘:
1. 보안 취약점
2. 성능 문제
3. 가독성
4. 에러 처리

[코드 붙여넣기]
```

### AI 리뷰의 장점

- 빠른 초기 검토
- 놓치기 쉬운 패턴 탐지
- 일관된 기준 적용
- 24시간 가용

### AI 리뷰의 한계

- 비즈니스 로직 이해 부족
- 프로젝트 컨텍스트 모름
- 거짓 양성 (False Positive)
- 최종 판단은 사람이

### 효과적인 AI 리뷰 활용

```
1단계: AI로 초기 스캔
   - 보안 취약점 탐지
   - 일반적인 안티패턴 확인

2단계: AI 결과 검토
   - 유효한 지적인지 확인
   - 컨텍스트에 맞는지 판단

3단계: 수동 심층 리뷰
   - 비즈니스 로직 검증
   - 아키텍처 적합성 확인
```

---

## 5. 실습: 코드 리뷰 연습

### 실습 코드

다음 코드를 리뷰하세요:

```python
# user_service.py
import sqlite3

def get_user(user_id):
    conn = sqlite3.connect('users.db')
    cursor = conn.cursor()
    query = f"SELECT * FROM users WHERE id = {user_id}"
    result = cursor.execute(query).fetchone()
    return result

def create_user(name, email, password):
    conn = sqlite3.connect('users.db')
    cursor = conn.cursor()
    query = f"INSERT INTO users (name, email, password) VALUES ('{name}', '{email}', '{password}')"
    cursor.execute(query)
    conn.commit()
    return True

def delete_user(user_id):
    conn = sqlite3.connect('users.db')
    c = conn.cursor()
    c.execute(f"DELETE FROM users WHERE id = {user_id}")
    conn.commit()
```

### 리뷰 작성

위 코드에서 발견한 문제를 아래 형식으로 작성하세요:

```
## 리뷰 결과

### 1. [유형] 제목
- 위치: 파일명:라인
- 문제: 설명
- 제안: 개선 방안

### 2. [유형] 제목
...
```

### 힌트

다음 관점에서 검토하세요:
- [ ] SQL 인젝션
- [ ] 비밀번호 저장 방식
- [ ] 데이터베이스 연결 관리
- [ ] 에러 처리
- [ ] 변수 명명

---

## 6. 체크리스트

리뷰 시 참고할 체크리스트는 [review-checklist.md](./review-checklist.md)를 확인하세요.

---

## 자가 점검

- [ ] 코드 리뷰의 목적을 설명할 수 있다
- [ ] 체계적인 리뷰 순서를 알고 있다
- [ ] 건설적인 피드백을 작성할 수 있다
- [ ] AI 리뷰 도구를 적절히 활용할 수 있다
- [ ] 보안 관련 코드 문제를 발견할 수 있다

---

## 다음 세션

**테스트 작성**으로 넘어갑니다.
pytest를 사용하여 단위 테스트를 작성합니다.
